<!-- Crie um arquivo chamado mapa-mundi.html e cole este c√≥digo: -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blaze and Steel - Mapa Mundi</title>
    <style>
        /* O mesmo CSS que enviei anteriormente */
        body {
            margin: 0;
            padding: 0;
            background: #0a0a1a;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
            color: white;
        }

        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: #000 url('../assets/mapa-mundi.jpg') no-repeat center center;
            background-size: cover;
        }

        .region {
            position: absolute;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(2px);
            color: white;
            text-align: center;
            padding: 10px;
            box-sizing: border-box;
            width: 150px;
            height: 80px;
            z-index: 100; /* Garante que as regi√µes fiquem acima de outros elementos */
            pointer-events: auto; /* Garante que as regi√µes possam receber cliques */
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        .region:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
            border-color: #e74c3c;
        }

        .region.locked {
            filter: grayscale(80%);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .region-level {
            font-size: 12px;
            color: #ffcc00;
            margin-top: 5px;
        }

        .region-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        #player-info {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #444;
            z-index: 100;
        }

        .stat {
            margin: 5px 0;
        }

        .stat-label {
            color: #aaa;
            font-size: 0.9em;
        }

        .stat-value {
            color: #fff;
            font-weight: bold;
        }

        #battle-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .enemy-display {
            text-align: center;
            margin-bottom: 30px;
        }

        .enemy-image-container {
            width: 200px;
            height: 200px;
            margin: 10px auto;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            overflow: hidden;
        }

        .enemy-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .enemy-health {
            width: 300px;
            height: 20px;
            background: #333;
            border-radius: 10px;
            margin: 10px auto;
            overflow: hidden;
        }

        .health-bar {
            height: 100%;
            background: #e74c3c;
            width: 100%;
            transition: width 0.3s;
        }

        .battle-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .battle-btn {
            padding: 10px 20px;
            font-size: 1.1em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .battle-btn:hover {
            transform: translateY(-2px);
        }

        #attack-btn {
            background: #e74c3c;
            color: white;
        }

        #flee-btn {
            background: #3498db;
            color: white;
        }

        #battle-log {
            width: 80%;
            max-width: 600px;
            height: 150px;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #444;
            border-radius: 5px;
            margin-top: 20px;
            padding: 10px;
            overflow-y: auto;
            font-family: monospace;
        }

        .log-entry {
            margin: 5px 0;
            padding: 3px 0;
            border-bottom: 1px solid #333;
        }

        .victory-screen, .defeat-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1001;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            text-align: center;
        }

        .victory-screen h1 {
            color: #2ecc71;
            font-size: 3em;
            margin-bottom: 20px;
        }

        .defeat-screen h1 {
            color: #e74c3c;
            font-size: 3em;
            margin-bottom: 20px;
        }

        .continue-btn {
            margin-top: 20px;
            padding: 10px 30px;
            font-size: 1.2em;
            background: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .continue-btn:hover {
            background: #2980b9;
        }

        /* Estilos para o menu de status */
        #status-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #e74c3c;
            color: white;
            font-size: 24px;
            cursor: pointer;
            z-index: 100;
            transition: all 0.3s ease;
        }

        #status-btn:hover {
            background: #e74c3c;
            transform: scale(1.1);
        }

        /* Modal de status */
        #status-modal {
            display: none; /* Inicialmente oculto */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 2000; /* Garante que fique acima de outros elementos */
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(3px);
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: auto; /* Garante que o modal possa receber eventos de clique */
        }
        
        #status-modal.show {
            display: flex !important;
            opacity: 1;
            visibility: visible;
        }

        #status-modal h2 {
            color: #e74c3c;
            text-align: center;
            margin-top: 0;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }

        .status-group {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        .status-group h3 {
            color: #e74c3c;
            margin-top: 0;
            border-bottom: 1px solid #333;
            padding-bottom: 5px;
        }

        .stat-bar-container {
            margin: 10px 0;
        }

        .stat-bar {
            height: 20px;
            background: #333;
            border-radius: 10px;
            margin: 5px 0;
            overflow: hidden;
        }

        .stat-bar-fill {
            height: 100%;
            background: #e74c3c;
            transition: width 0.3s;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 5px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }

        .stat-label {
            color: #aaa;
        }

        .stat-value {
            color: #fff;
            font-weight: bold;
        }

        #close-status {
            display: block;
            margin: 20px auto 0;
            padding: 10px 30px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background 0.3s;
        }

        #close-status:hover {
            background: #c0392b;
        }

        /* Anima√ß√µes */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .status-update {
            animation: pulse 1s;
        }

        /* Estilos para o invent√°rio */
        .action-buttons {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            gap: 10px;
            z-index: 100;
        }

        .action-btn {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #8b5a2b;
            color: #fff;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .regions-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #8b5a2b;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .regions-btn:hover {
            background: rgba(139, 90, 43, 0.5);
            transform: scale(1.05);
        }

        .action-btn:hover {
            background: rgba(139, 90, 43, 0.7);
            transform: scale(1.1);
        }

        .inventory-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);

            .inventory-container {
                background: #1a1a1a;
                border: 3px solid #8b5a2b;
                border-radius: 10px;
                width: 80%;
                max-width: 800px;
                max-height: 80vh;
                padding: 20px;
                display: flex;
                flex-direction: column;
                color: #fff;
            }
            flex-direction: column;
            color: #fff;
        }

        .inventory-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 2px solid #8b5a2b;
            padding-bottom: 10px;
        }

        .inventory-tabs {
            display: flex;
            gap: 5px;
        }

        .inventory-tab {
            background: #333;
            border: 1px solid #555;
            color: #fff;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        .inventory-tab.active {
            background: #8b5a2b;
            border-color: #c19a6b;
        }

        .close-btn {
            background: #8b5a2b;
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .inventory-slots {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            margin-bottom: 15px;
            max-height: 300px;
        }

        .inventory-slot {
            aspect-ratio: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #8b5a2b;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            padding: 5px;
        }

        .inventory-slot:hover {
            background: rgba(139, 90, 43, 0.3);
            transform: scale(1.05);
        }

        .inventory-slot.selected {
            background: rgba(139, 90, 43, 0.5);
            border-color: #c19a6b;
            box-shadow: 0 0 10px #c19a6b;
        }

        .inventory-slot .item-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .inventory-slot .item-quantity {
            position: absolute;
            bottom: 2px;
            right: 5px;
            font-size: 12px;
            background: rgba(0, 0, 0, 0.7);
            padding: 0 4px;
            border-radius: 10px;
        }

        .inventory-info {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            min-height: 80px;
        }

        .inventory-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .action-button {
            padding: 8px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }

        .action-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        #use-item-btn {
            background: #27ae60;
            color: white;
        }

        #use-item-btn:not(:disabled):hover {
            background: #2ecc71;
        }

        #drop-item-btn {
            background: #c0392b;
            color: white;
        }

        #drop-item-btn:not(:disabled):hover {
            background: #e74c3c;
        }

        /* Estilos para o modal de status */
        #status-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: auto;
        }

        #status-modal.show {
            display: flex;
            opacity: 1;
        }

        .status-container {
            background: #1a1a2e;
            border: 2px solid #e74c3c;
            border-radius: 10px;
            padding: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
            opacity: 0;
        }

        #status-modal.show .status-container {
            transform: translateY(0);
            opacity: 1;
        }

        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }

        .status-header h2 {
            margin: 0;
            color: #e74c3c;
        }

        .close-btn {
            background: none;
            border: none;
            color: #fff;
            font-size: 24px;
            cursor: pointer;
            padding: 0 10px;
        }

        .close-btn:hover {
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <script>
        // Bloco try-catch global para capturar erros iniciais
        window.onerror = function(message, source, lineno, colno, error) {
            console.error('Erro global:', {message, source, lineno, colno, error});
            alert('Ocorreu um erro no jogo. Verifique o console para mais detalhes.');
            return true; // Impede o comportamento padr√£o do navegador
        };

        // Garante que a fun√ß√£o openStatusMenu esteja dispon√≠vel globalmente
        window.openStatusMenu = function() {
            console.log('=== openStatusMenu global chamada ===');
            try {
                // Tenta chamar a fun√ß√£o saveGame se existir
                if (typeof saveGame === 'function') {
                    console.log('Chamando saveGame...');
                    saveGame();
                } else {
                    console.warn('saveGame n√£o √© uma fun√ß√£o');
                }
                
                console.log('Redirecionando para status.html');
                window.location.href = 'status.html';
            } catch (error) {
                console.error('Erro em openStatusMenu:', error);
                // Tenta redirecionar mesmo em caso de erro
                window.location.href = 'status.html';
            }
            return false;
        };

        // Log quando o script global √© carregado
        console.log('Script global carregado. openStatusMenu dispon√≠vel:', typeof window.openStatusMenu === 'function');
    </script>
    <div id="game-container">
        <!-- Bot√µes de A√ß√£o -->
        <div class="action-buttons">
            <button id="inventory-btn" class="action-btn" title="Abrir Invent√°rio">üéí</button>
            <a href="status.html" id="status-btn" title="Abrir Status" style="display: flex; align-items: center; justify-content: center; width: 70px; height: 70px; background: transparent !important; border: none !important; padding: 0; margin: 0 5px;">
                <img src="../assets/icones/menu_status.png" alt="Status" style="width: 90%; height: 90%; object-fit: contain; display: block;">
            </a>
        </div>
        <style>
            /* Garante que o link do bot√£o de status tenha a mesma apar√™ncia do bot√£o */
            /* Estilo para os bot√µes de a√ß√£o */
            .action-buttons a.action-btn {
                text-decoration: none;
                display: flex;
                align-items: center;
                justify-content: center;
                width: 50px;
                height: 50px;
                border-radius: 50%;
                background: rgba(0, 0, 0, 0.7);
                border: 2px solid #8b5a2b;
                transition: all 0.2s;
            }

            /* Estilo para o bot√£o de status */
            #status-btn {
                background: transparent !important;
                margin: 0;
                display: block;
                padding: 0;
                margin: 0;
                border: none !important;
                overflow: visible;
                box-shadow: none;
            }
            
            #status-btn:hover {
                transform: scale(1.1);
                background: none !important;
            }
            
            #status-btn img {
                width: 100%;
                height: 100%;
                object-fit: contain;
                padding: 8px;
                object-fit: contain;
            }
            
            /* Efeito hover */
            #status-btn:hover {
                transform: scale(1.1);
                background: none !important;
            }
        </style>
        
        <!-- Modal de Status -->
        <div id="status-modal" class="status-modal">
            <div class="status-container">
                <div class="status-header">
                    <h2>Status do Personagem</h2>
                    <button id="close-status" class="close-btn">‚úï</button>
                </div>
                <div class="status-content">
                    <div class="status-group">
                        <h3>Informa√ß√µes B√°sicas</h3>
                        <div class="stat-row">
                            <span class="stat-label">Nome:</span>
                            <span id="char-name" class="stat-value">Aventureiro</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Classe:</span>
                            <span id="char-class" class="stat-value">Guerreiro</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">N√≠vel:</span>
                            <span id="char-level" class="stat-value">1</span>
                        </div>
                        <div class="stat-row">
                            <span class="stat-label">Experi√™ncia:</span>
                            <span id="char-exp" class="stat-value">0/100</span>
                        </div>
                    </div>
                    
                    <div class="status-group">
                        <h3>Atributos</h3>
                        <div class="stat-row">
                            <span class="stat-label">Vida (HP):</span>
                            <span id="hp-text" class="stat-value">100/100</span>
                        </div>
                        <div class="stat-bar-container">
                            <div class="stat-bar">
                                <div id="hp-bar" class="stat-bar-fill" style="width: 100%"></div>
                            </div>
                        </div>
                        
                        <div class="stat-row">
                            <span class="stat-label">Mana (MP):</span>
                            <span id="mp-text" class="stat-value">50/50</span>
                        </div>
                        <div class="stat-bar-container">
                            <div class="stat-bar">
                                <div id="mp-bar" class="stat-bar-fill" style="width: 100%; background: #3498db;"></div>
                            </div>
                            <span id="mp-text">50/50</span>
                        </div>
                        
                        <div class="stat-row">
                            <span class="stat-label">Ataque:</span>
                            <span id="char-atk" class="stat-value">10</span>
                        </div>
                        
                        <div class="stat-row">
                            <span class="stat-label">Defesa:</span>
                            <span id="char-def" class="stat-value">5</span>
                        </div>
                        
                        <div class="stat-row">
                            <span class="stat-label">Velocidade:</span>
                            <span id="char-spd" class="stat-value">8</span>
                        </div>
                        
                        <div class="stat-row">
                            <span class="stat-label">Intelig√™ncia:</span>
                            <span id="char-int" class="stat-value">5</span>
                        </div>
                    </div>
                    
                    <div class="status-group">
                        <h3>Equipamentos</h3>
                        <p><strong>Arma:</strong> <span id="char-weapon">Espada Inicial</span></p>
                        <p><strong>Armadura:</strong> <span id="char-armor">Armadura de Couro</span></p>
                        <p><strong>Acess√≥rio:</strong> <span id="char-accessory">Nenhum</span></p>
                    </div>
                    
                    <button id="close-status" class="btn">Fechar</button>
                </div>
            </div>
        </div>
        
        <!-- Regi√µes do mapa -->
        <div class="region" style="top: 60%; left: 20%;" data-region="floresta" data-level="1-5" onclick="window.location.href='floresta-iniciantes.html';">
            <div class="region-name">Floresta dos Iniciantes</div>
            <div class="region-level">N√≠vel 1-5</div>
        </div>

        <div class="region locked" style="top: 40%; left: 35%;" data-region="montanhas" data-level="5-10">
            <div class="region-name">Montanhas G√©lidas</div>
            <div class="region-level">N√≠vel 5-10</div>
        </div>

        <div class="region locked" style="top: 30%; left: 60%;" data-region="deserto" data-level="10-15">
            <div class="region-name">Deserto Ardente</div>
            <div class="region-level">N√≠vel 10-15</div>
        </div>

        <div class="region locked" style="top: 55%; left: 75%;" data-region="pantano" data-level="15-20">
            <div class="region-name">P√¢ntano Sombrio</div>
            <div class="region-level">N√≠vel 15-20</div>
        </div>

        <div class="region locked" style="top: 25%; left: 25%;" data-region="castelo" data-level="20+">
            <div class="region-name">Castelo do Rei Dem√¥nio</div>
            <div class="region-level">N√≠vel 20+</div>
        </div>

        <!-- Informa√ß√µes do jogador -->
        <div id="player-info">
            <div class="stat">
                <span class="stat-label">N√≠vel:</span>
                <span class="stat-value" id="player-level">1</span>
            </div>
            <div class="stat">
                <span class="stat-label">EXP:</span>
                <span class="stat-value" id="player-exp">0/100</span>
            </div>
            <div class="stat">
                <span class="stat-label">Vida:</span>
                <span class="stat-value" id="player-health">100/100</span>
            </div>
            <div class="stat">
                <span class="stat-label">Ouro:</span>
                <span class="stat-value" id="player-gold">10</span>
            </div>
        </div>
    </div>

    <!-- Tela de Batalha -->
    <div id="battle-screen">
        <div class="enemy-display">
            <h2 id="enemy-name">Inimigo</h2>
            <div>N√≠vel <span id="enemy-level">1</span></div>
            <div class="enemy-image-container">
                <img id="enemy-image" src="" alt="Inimigo" class="enemy-image">
            </div>
            <div class="enemy-health">
                <div class="health-bar" id="enemy-health-bar"></div>
            </div>
            <div id="enemy-health-text">100/100</div>
        </div>

        <div class="battle-actions">
            <button id="attack-btn" class="battle-btn">ATACAR</button>
            <button id="flee-btn" class="battle-btn">FUGIR</button>
        </div>

        <div id="battle-log">
            <div class="log-entry">Uma batalha come√ßou!</div>
        </div>
    </div>

    <!-- Tela de Vit√≥ria -->
    <div class="victory-screen" id="victory-screen">
        <h1>VIT√ìRIA!</h1>
        <p id="victory-text">Voc√™ derrotou o inimigo e ganhou 10 de EXP e 5 de ouro!</p>
        <button class="continue-btn" id="continue-btn">Continuar</button>
    </div>

    <!-- Tela de Derrota -->
    <div class="defeat-screen" id="defeat-screen">
        <h1>DERROTA</h1>
        <p>Voc√™ foi derrotado em batalha...</p>
        <button class="continue-btn" id="retry-btn">Tentar Novamente</button>
    </div>

    <!-- Tela de Invent√°rio -->
    <div id="inventory-screen" class="inventory-screen">
        <div class="inventory-container">
            <h2>Invent√°rio</h2>
            <div class="inventory-header">
                <div class="inventory-tabs">
                    <button class="inventory-tab active" data-tab="all">Todos</button>
                    <button class="inventory-tab" data-tab="consumable">Consum√≠veis</button>
                    <button class="inventory-tab" data-tab="weapon">Armas</button>
                    <button class="inventory-tab" data-tab="armor">Armaduras</button>
                </div>
                <button id="close-inventory" class="close-btn">‚úï</button>
            </div>
            <div class="inventory-slots" id="inventory-slots">
                <!-- Itens ser√£o adicionados aqui dinamicamente -->
            </div>
            <div class="inventory-info" id="inventory-info">
                <p>Selecione um item para ver mais informa√ß√µes</p>
            </div>
            <div class="inventory-actions">
                <button id="use-item-btn" class="action-button" disabled>Usar</button>
                <button id="drop-item-btn" class="action-button" disabled>Largar</button>
            </div>
        </div>
    </div>

    <script>
        // Estado do jogo
        // Defini√ß√£o dos itens do jogo
        const gameItems = {
            healthPotion: {
                id: 'healthPotion',
                name: 'Po√ß√£o de Cura',
                description: 'Restaura 30 de vida',
                type: 'consumable',
                effect: { health: 30 },
                value: 10,
                icon: '‚ù§Ô∏è'
            },
            manaPotion: {
                id: 'manaPotion',
                name: 'Po√ß√£o de Mana',
                description: 'Restaura 20 de mana',
                type: 'consumable',
                effect: { mana: 20 },
                value: 15,
                icon: 'üîµ'
            },
            ironSword: {
                id: 'ironSword',
                name: 'Espada de Ferro',
                description: 'Aumenta o ataque em 5',
                type: 'weapon',
                effect: { attack: 5 },
                value: 50,
                icon: '‚öîÔ∏è'
            },
            leatherArmor: {
                id: 'leatherArmor',
                name: 'Armadura de Couro',
                description: 'Aumenta a defesa em 3',
                type: 'armor',
                effect: { defense: 3 },
                value: 40,
                icon: 'üõ°Ô∏è'
            }
        };

        const gameState = {
            player: {
                level: 1,
                exp: 0,
                expToNextLevel: 100,
                stats: {
                    health: 100,
                    maxHealth: 100,
                    mana: 50,
                    maxMana: 50,
                    attack: 10,
                    defense: 5,
                    gold: 50
                },
                unlockedRegions: ['floresta'],
                inventory: {
                    items: [],
                    maxSlots: 20,
                    equipped: {
                        weapon: null,
                        armor: null,
                        accessory: null
                    }
                }
            },
            currentEnemy: null,
            inBattle: false,
            battleLog: []
        };

        // Inimigos por regi√£o
        const enemiesByRegion = {
            'floresta': [
                { 
                    name: 'Lobo', 
                    level: 1, 
                    health: 50, 
                    maxHealth: 50, 
                    attack: 8, 
                    defense: 2, 
                    exp: 20, 
                    gold: 5,
                    image: '../assets/monstros/Lobo.png'
                },
                { 
                    name: 'Goblin', 
                    level: 2, 
                    health: 60, 
                    maxHealth: 60, 
                    attack: 10, 
                    defense: 3, 
                    exp: 25, 
                    gold: 7,
                    image: '../assets/monstros/Goblin.png'
                },
                { 
                    name: 'Aranha Gigante', 
                    level: 3, 
                    health: 70, 
                    maxHealth: 70, 
                    attack: 12, 
                    defense: 4, 
                    exp: 30, 
                    gold: 10,
                    image: '../assets/monstros/Aranha Gigante.png'
                }
            ],
            'montanhas': [
                { 
                    name: 'Yeti', 
                    level: 5, 
                    health: 100, 
                    maxHealth: 100, 
                    attack: 15, 
                    defense: 8, 
                    exp: 50, 
                    gold: 15,
                    image: '../assets/Yeti.png'
                },
                { 
                    name: 'Elemental de Gelo', 
                    level: 7, 
                    health: 120, 
                    maxHealth: 120, 
                    attack: 18, 
                    defense: 10, 
                    exp: 70, 
                    gold: 20,
                    image: '../assets/Elemental de Gelo.png'
                }
            ],
            'deserto': [
                { name: 'Escorpi√£o da Areia', level: 10, health: 150, maxHealth: 150, attack: 22, defense: 12, exp: 100, gold: 30 },
                { name: 'M√∫mia', level: 12, health: 180, maxHealth: 180, attack: 25, defense: 15, exp: 120, gold: 40 }
            ],
            'pantano': [
                { name: 'Slime T√≥xico', level: 15, health: 200, maxHealth: 200, attack: 28, defense: 18, exp: 150, gold: 50 },
                { name: 'Esp√≠rito do P√¢ntano', level: 18, health: 250, maxHealth: 250, attack: 32, defense: 20, exp: 180, gold: 60 }
            ],
            'castelo': [
                { name: 'Cavaleiro Negro', level: 20, health: 300, maxHealth: 300, attack: 35, defense: 25, exp: 250, gold: 100 },
                { name: 'Rei Dem√¥nio', level: 25, health: 500, maxHealth: 500, attack: 45, defense: 35, exp: 500, gold: 250 }
            ]
        };

        // Log para verificar se o script est√° sendo carregado
        console.log('=== SCRIPT DO MAPA MUNDI CARREGADO ===');

        // Vari√°veis globais para controle do invent√°rio
        let selectedItemId = null;
        let currentFilter = 'all';

        // Fun√ß√µes para gerenciar itens no invent√°rio
        function addItemToInventory(itemId, quantity = 1) {
            const item = gameItems[itemId];
            if (!item) return false;

            const inventory = gameState.player.inventory;
            const existingItem = inventory.items.find(i => i.id === itemId);

            if (existingItem) {
                // Se o item j√° existe, apenas incrementa a quantidade
                existingItem.quantity += quantity;
            } else {
                // Verifica se h√° espa√ßo no invent√°rio
                if (inventory.items.length >= inventory.maxSlots) {
                    addToBattleLog('Seu invent√°rio est√° cheio!');
                    return false;
                }
                // Adiciona um novo item ao invent√°rio
                inventory.items.push({
                    id: itemId,
                    quantity: quantity
                });
            }

            addToBattleLog(`Voc√™ obteve ${quantity}x ${item.name}!`);
            saveGame();
            updateUI();
            return true;
        }

        function removeItemFromInventory(itemId, quantity = 1) {
            const inventory = gameState.player.inventory;
            const itemIndex = inventory.items.findIndex(i => i.id === itemId);

            if (itemIndex === -1) return false;

            const item = inventory.items[itemIndex];

            if (item.quantity > quantity) {
                // Reduz a quantidade do item
                item.quantity -= quantity;
            } else {
                // Remove o item do invent√°rio se a quantidade for menor ou igual a zero
                inventory.items.splice(itemIndex, 1);
            }

            saveGame();
            updateUI();
            return true;
        }

        function useItem(itemId) {
            const item = gameItems[itemId];
            if (!item) return false;

            const player = gameState.player;

            // Verifica se o item est√° no invent√°rio
            const inventoryItem = player.inventory.items.find(i => i.id === itemId);
            if (!inventoryItem) return false;

            // Aplica o efeito do item
            let message = '';

            if (item.type === 'consumable') {
                if (item.effect.health) {
                    player.stats.health = Math.min(
                        player.stats.maxHealth,
                        player.stats.health + item.effect.health
                    );
                    message = `Voc√™ recuperou ${item.effect.health} de vida!`;
                }

                if (item.effect.mana) {
                    player.stats.mana = Math.min(
                        player.stats.maxMana,
                        player.stats.mana + item.effect.mana
                    );
                    message = message ? message + ' E ' : 'Voc√™ ';
                    message += `recuperou ${item.effect.mana} de mana!`;
                }

                // Remove o item do invent√°rio ap√≥s o uso
                removeItemFromInventory(itemId, 1);
            } else if (item.type === 'weapon' || item.type === 'armor') {
                // Equipa o item
                const slot = item.type;
                const player = gameState.player;
                
                // Se j√° tiver um item equipado, remove seus b√¥nus
                if (player.inventory.equipped[slot] === itemId) {
                    // Desequipa o item
                    const equippedItem = gameItems[player.inventory.equipped[slot]];
                    if (equippedItem) {
                        // Remove os b√¥nus do item
                        Object.entries(equippedItem.effect).forEach(([stat, value]) => {
                            player.stats[stat] -= value;
                        });
                    }
                    
                    // Adiciona o item de volta ao invent√°rio
                    addItemToInventory(itemId, 1);
                    player.inventory.equipped[slot] = null;
                    addToBattleLog(`Voc√™ desequipou ${item.name}.`);
                } else {
                    // Equipa o novo item
                    useItem(itemId);
                }
            }

            // Atualiza a UI
            updateUI();
            updateStatusDisplay();

            if (message) {
                addToBattleLog(message);
            }

            return true;
        }

        // Adiciona itens iniciais ao invent√°rio
        function addStartingItems() {
            addItemToInventory('healthPotion', 3);
            addItemToInventory('manaPotion', 2);
            addItemToInventory('ironSword', 1);
            addItemToInventory('leatherArmor', 1);
        }

        // Fun√ß√µes para controle do invent√°rio
        function openInventory() {
            document.getElementById('inventory-screen').style.display = 'flex';
            renderInventory();
        }

        function closeInventory() {
            document.getElementById('inventory-screen').style.display = 'none';
            selectedItemId = null;
            updateInventoryButtons();
        }

        function renderInventory() {
            const inventorySlots = document.getElementById('inventory-slots');
            inventorySlots.innerHTML = '';
            
            const player = gameState.player;
            const items = player.inventory.items;
            
            // Filtra os itens com base na aba selecionada
            const filteredItems = items.filter(item => {
                const itemData = gameItems[item.id];
                if (currentFilter === 'all') return true;
                return itemData.type === currentFilter;
            });

            // Adiciona os itens filtrados
            filteredItems.forEach(item => {
                const itemData = gameItems[item.id];
                if (!itemData) return;
                
                const itemElement = document.createElement('div');
                itemElement.className = `inventory-slot ${selectedItemId === item.id ? 'selected' : ''}`;
                itemElement.dataset.itemId = item.id;
                
                itemElement.innerHTML = `
                    <div class="item-icon">${itemData.icon || '‚ùì'}</div>
                    <div class="item-name">${itemData.name}</div>
                    ${item.quantity > 1 ? `<div class="item-quantity">${item.quantity}</div>` : ''}
                `;
                
                itemElement.addEventListener('click', () => selectItem(item.id));
                inventorySlots.appendChild(itemElement);
            });
            
            // Atualiza as informa√ß√µes do item selecionado
            updateItemInfo();
        }

        function selectItem(itemId) {
            selectedItemId = selectedItemId === itemId ? null : itemId;
            renderInventory();
            updateInventoryButtons();
        }

        function updateItemInfo() {
            const infoElement = document.getElementById('inventory-info');
            
            if (!selectedItemId) {
                infoElement.innerHTML = '<p>Selecione um item para ver mais informa√ß√µes</p>';
                return;
            }
            
            const itemData = gameItems[selectedItemId];
            if (!itemData) {
                infoElement.innerHTML = '<p>Item n√£o encontrado</p>';
                return;
            }
            
            let infoHTML = `
                <h3>${itemData.name}</h3>
                <p>${itemData.description}</p>
                <p><strong>Tipo:</strong> ${getItemTypeName(itemData.type)}</p>
            `;
            
            // Adiciona informa√ß√µes espec√≠ficas do tipo de item
            if (itemData.type === 'consumable') {
                if (itemData.effect.health) {
                    infoHTML += `<p><strong>Efeito:</strong> Restaura ${itemData.effect.health} de vida</p>`;
                }
                if (itemData.effect.mana) {
                    infoHTML += `<p><strong>Efeito:</strong> Restaura ${itemData.effect.mana} de mana</p>`;
                }
            } else if (itemData.type === 'weapon' || itemData.type === 'armor') {
                const effectText = Object.entries(itemData.effect)
                    .map(([stat, value]) => `${stat === 'attack' ? 'Ataque' : 'Defesa'}: ${value > 0 ? '+' : ''}${value}`)
                    .join(', ');
                infoHTML += `<p><strong>B√¥nus:</strong> ${effectText}</p>`;
            }
            
            infoElement.innerHTML = infoHTML;
        }

        function getItemTypeName(type) {
            const types = {
                'consumable': 'Consum√≠vel',
                'weapon': 'Arma',
                'armor': 'Armadura',
                'accessory': 'Acess√≥rio'
            };
            return types[type] || 'Desconhecido';
        }

        function updateInventoryButtons() {
            const useButton = document.getElementById('use-item-btn');
            const dropButton = document.getElementById('drop-item-btn');
            
            if (!selectedItemId) {
                useButton.disabled = true;
                dropButton.disabled = true;
                return;
            }
            
            const itemData = gameItems[selectedItemId];
            useButton.disabled = false;
            useButton.textContent = itemData.type === 'consumable' ? 'Usar' : 'Equipar';
            dropButton.disabled = false;
        }

        function useSelectedItem() {
            if (!selectedItemId) return;
            
            const itemData = gameItems[selectedItemId];
            if (!itemData) return;
            
            // Se for um item equip√°vel, equipa/remove do equipamento
            if (itemData.type === 'weapon' || itemData.type === 'armor') {
                const slot = itemData.type;
                const player = gameState.player;
                
                // Se j√° tiver um item equipado, remove primeiro
                if (player.inventory.equipped[slot] === selectedItemId) {
                    // Desequipa o item
                    const equippedItem = gameItems[player.inventory.equipped[slot]];
                    if (equippedItem) {
                        // Remove os b√¥nus do item
                        Object.entries(equippedItem.effect).forEach(([stat, value]) => {
                            player.stats[stat] -= value;
                        });
                    }
                    
                    // Adiciona o item de volta ao invent√°rio
                    addItemToInventory(selectedItemId, 1);
                    player.inventory.equipped[slot] = null;
                    addToBattleLog(`Voc√™ desequipou ${itemData.name}.`);
                } else {
                    // Equipa o novo item
                    useItem(selectedItemId);
                }
            } else {
                // Usa o item (consum√≠vel)
                useItem(selectedItemId);
            }
            
            // Atualiza a interface
            updateUI();
            updateStatusDisplay();
            renderInventory();
            selectedItemId = null;
            updateInventoryButtons();
        }

        function dropSelectedItem() {
            if (!selectedItemId) return;
            
            const itemData = gameItems[selectedItemId];
            if (!itemData) return;
            
            // Remove o item do invent√°rio
            removeItemFromInventory(selectedItemId, 1);
            addToBattleLog(`Voc√™ largou 1x ${itemData.name}.`);
            
            // Atualiza a interface
            renderInventory();
            selectedItemId = null;
            updateInventoryButtons();
        }

        // Fun√ß√µes para controle do menu de status
        function openStatusMenu() {
            console.log('=== openStatusMenu chamada ===');
            // Salva o estado do jogo antes de abrir o menu de status
            saveGame();
            // Redireciona para a p√°gina de status
            window.location.href = 'status.html';
        }

        function updateStatusDisplay() {
            console.log('=== updateStatusDisplay chamada ===');
            const player = gameState.player;
            const stats = player.stats;
            
            // Atualiza informa√ß√µes b√°sicas
            document.getElementById('char-level').textContent = player.level;
            document.getElementById('char-exp').textContent = `${player.exp || 0}/${player.expToNextLevel || 100}`;
            
            // Atualiza atributos
            document.getElementById('hp-text').textContent = `${Math.floor(stats.health)}/${stats.maxHealth}`;
            document.getElementById('mp-text').textContent = `${Math.floor(stats.mana)}/${stats.maxMana}`;
            document.getElementById('char-atk').textContent = Math.floor(stats.attack);
            document.getElementById('char-def').textContent = Math.floor(stats.defense);
            document.getElementById('char-spd').textContent = Math.floor(stats.speed || 10);
            document.getElementById('char-int').textContent = Math.floor(stats.intelligence || 5);
            
            // Atualiza barras de status
            const hpPercent = (stats.health / stats.maxHealth) * 100;
            document.getElementById('hp-bar').style.width = `${Math.min(100, Math.max(0, hpPercent))}%`;
            
            const mpPercent = (stats.mana / stats.maxMana) * 100;
            document.getElementById('mp-bar').style.width = `${Math.min(100, Math.max(0, mpPercent))}%`;
            
            // Atualiza equipamentos
            const equipped = player.inventory.equipped;
            const weapon = equipped.weapon ? gameItems[equipped.weapon] : null;
            const armor = equipped.armor ? gameItems[equipped.armor] : null;
            const accessory = equipped.accessory ? gameItems[equipped.accessory] : null;
            
            document.getElementById('char-weapon').textContent = weapon ? weapon.name : 'Nenhuma';
            document.getElementById('char-armor').textContent = armor ? armor.name : 'Nenhuma';
            document.getElementById('char-accessory').textContent = accessory ? accessory.name : 'Nenhum';
            
            // Atualiza ouro
            document.getElementById('player-gold').textContent = Math.floor(stats.gold || 0);
        }

        // Configura os ouvintes de eventos
        function setupEventListeners() {
            console.log('=== setupEventListeners chamado ===');
            
            // Bot√£o de invent√°rio
            console.log('Procurando bot√£o de invent√°rio...');
            const inventoryBtn = document.getElementById('inventory-btn');
            console.log('Bot√£o de invent√°rio encontrado:', inventoryBtn);
            if (inventoryBtn) {
                console.log('Adicionando event listener ao bot√£o de invent√°rio');
                inventoryBtn.addEventListener('click', openInventory);
                console.log('Ouvinte do bot√£o de invent√°rio adicionado');
            } else {
                console.error('Bot√£o de invent√°rio n√£o encontrado!');
            }
            
            const closeInventoryBtn = document.getElementById('close-inventory');
            if (closeInventoryBtn) {
                closeInventoryBtn.addEventListener('click', closeInventory);
            } else {
                console.error('Bot√£o de fechar invent√°rio n√£o encontrado!');
            }
            
            // Bot√£o de status
            console.log('Procurando bot√£o de status...');
            const statusBtn = document.getElementById('status-btn');
            const statusModal = document.getElementById('status-modal');
            const closeStatusBtn = document.getElementById('close-status');
            
            console.log('=== Elementos do status ===');
            console.log('Bot√£o de status:', statusBtn);
            console.log('Modal de status:', statusModal);
            console.log('Bot√£o fechar status:', closeStatusBtn);
            
            // Configura o manipulador de eventos para o bot√£o de status
            if (statusBtn) {
                console.log('Configurando manipulador de eventos para o bot√£o de status');
                // Remove qualquer manipulador de evento existente para evitar duplica√ß√£o
                statusBtn.onclick = null;
                // Adiciona o novo manipulador de evento
                statusBtn.addEventListener('click', function(e) {
                    console.log('Bot√£o de status clicado!');
                    openStatusMenu();
                    // Impede o comportamento padr√£o do bot√£o
                    e.preventDefault();
                    return false;
                });
                console.log('Manipulador de eventos do bot√£o de status configurado com sucesso');
            } else {
                console.error('ERRO: Bot√£o de status n√£o encontrado no DOM!');
            }
            
            if (closeStatusBtn) {
                closeStatusBtn.addEventListener('click', closeStatusMenu);
            } else {
                console.error('Bot√£o de fechar status n√£o encontrado!');
            }
            
            // Bot√£o de dropar item
            document.getElementById('drop-item-btn').addEventListener('click', dropSelectedItem);
            
            // Filtros do invent√°rio
            document.querySelectorAll('.inventory-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelector('.inventory-tab.active')?.classList.remove('active');
                    tab.classList.add('active');
                    currentFilter = tab.dataset.tab;
                    renderInventory();
                });
            });
            
            // Fechar invent√°rio com ESC
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && document.getElementById('inventory-screen').style.display === 'flex') {
                    closeInventory();
                }
            });

            // Configura o clique nas regi√µes
            console.log('=== INICIANDO CONFIGURA√á√ÉO DOS EVENTOS DE CLIQUE ===');
            const regions = document.querySelectorAll('.region');
            console.log(`=== CONFIGURANDO EVENTOS DE CLIQUE NAS REGI√ïES ===`);
            console.log(`Encontradas ${regions.length} regi√µes no DOM`);
            
            // Verifica se as regi√µes foram encontradas
            if (regions.length === 0) {
                console.error('NENHUMA REGI√ÉO ENCONTRADA NO DOCUMENTO!');
                console.log('Elementos com classe "region" encontrados:', document.getElementsByClassName('region'));
            } else {
                console.log('Regi√µes encontradas no documento:', regions);
            }
            
            regions.forEach((region, index) => {
                const regionName = region.getAttribute('data-region');
                const isLocked = region.classList.contains('locked');
                
                console.log(`Regi√£o ${index + 1}:`, {
                    id: region.id || 'sem-id',
                    classe: region.className,
                    'data-region': regionName,
                    'trancada': isLocked,
                    elemento: region
                });
                
                // Adiciona estilo para facilitar a visualiza√ß√£o
                region.style.cursor = 'pointer';
                region.style.border = '2px solid red';
                region.style.padding = '5px';
                
                // Adiciona o evento de clique √† regi√£o
                region.addEventListener('click', function(e) {
                    console.log('Regi√£o clicada:', regionName);
                    
                    // Mapeia os nomes das regi√µes para os arquivos HTML
                    const regionPages = {
                        'floresta': 'floresta-iniciantes.html',
                        'deserto': 'deserto-ardente.html',
                        'montanha': 'montanhas-gelidas.html',
                        'pantano': 'pantano-sombrio.html',
                        'castelo': 'castelo-rei-demonio.html'
                    };
                    
                    const targetPage = regionPages[regionName];
                    
                    console.log('Redirecionando para:', targetPage);
                    window.location.href = targetPage;
                    return false; // Impede o comportamento padr√£o do link
                });
                
                console.log(`Evento de clique configurado para a regi√£o: ${regionName}`);
            });
            
            // Inicializa o jogo
            try {
                // Adiciona itens iniciais se necess√°rio
                if (gameState.player.inventory.items.length === 0) {
                    addStartingItems();
                }
                
                // Atualiza a exibi√ß√£o inicial
                updateStatusDisplay();
                updateUI();
                
                // Desbloqueia as regi√µes iniciais
                unlockNewRegions();
                
                console.log('Jogo inicializado com sucesso!');
            } catch (error) {
                console.error('Erro ao inicializar o jogo:', error);
                alert('Ocorreu um erro ao carregar o jogo. Por favor, verifique o console para mais detalhes.');
            }
        }
        
        console.log('=== VERIFICANDO ESTADO DE CARREGAMENTO DO DOCUMENTO ===');
        console.log('document.readyState:', document.readyState);
        
        function startGameWrapper() {
            console.log('=== INICIANDO O JOGO ===');
            try {
                startGame();
                console.log('Jogo iniciado com sucesso!');
            } catch (error) {
                console.error('Erro ao iniciar o jogo:', error);
            }
        }
        
        if (document.readyState === 'loading') {
            console.log('Documento ainda n√£o carregado, aguardando evento DOMContentLoaded...');
            document.addEventListener('DOMContentLoaded', startGameWrapper);
        } else {
            console.log('Documento j√° carregado, iniciando jogo imediatamente');
            startGameWrapper();
        }

        // Inicia uma batalha em uma regi√£o
        function startBattleInRegion(regionName) {
            console.log('=== IN√çCIO DA FUN√á√ÉO startBattleInRegion ===');
            console.log('Regi√£o clicada:', regionName);
            console.log('Estado do jogo (gameState):', JSON.stringify(gameState, null, 2));
            
            // Verifica se a regi√£o existe em enemiesByRegion
            if (!enemiesByRegion) {
                console.error('ERRO CR√çTICO: enemiesByRegion √© null ou undefined!');
                return;
            }
            
            console.log('Registros em enemiesByRegion:', Object.keys(enemiesByRegion));
            
            if (!enemiesByRegion.hasOwnProperty(regionName)) {
                console.error('Regi√£o n√£o encontrada em enemiesByRegion:', regionName);
                console.log('Regi√µes dispon√≠veis:', Object.keys(enemiesByRegion));
                return;
            }
            
            const enemies = enemiesByRegion[regionName];
            console.log('Inimigos encontrados para a regi√£o', regionName, ':', enemies);
            
            if (!enemies || enemies.length === 0) {
                console.error('Nenhum inimigo encontrado para a regi√£o:', regionName);
                return;
            }
            
            console.log('N√∫mero de inimigos dispon√≠veis:', enemies.length);
            
            // Seleciona um inimigo aleat√≥rio
            const randomIndex = Math.floor(Math.random() * enemies.length);
            console.log('√çndice do inimigo selecionado:', randomIndex);
            
            const selectedEnemy = enemies[randomIndex];
            console.log('Inimigo selecionado:', selectedEnemy);
            
            if (!selectedEnemy) {
                console.error('Erro ao selecionar inimigo aleat√≥rio da regi√£o:', regionName);
                console.error('√çndice:', randomIndex, 'de', enemies.length, 'inimigos dispon√≠veis');
                return;
            }
            
            // Cria uma c√≥pia profunda do inimigo para n√£o modificar o original
            gameState.currentEnemy = {
                ...selectedEnemy,
                health: selectedEnemy.maxHealth // Garante que a vida est√° cheia
            };
            
            gameState.inBattle = true;
            
            // Mostra a tela de batalha
            const battleScreen = document.getElementById('battle-screen');
            if (battleScreen) {
                battleScreen.style.display = 'flex';
            } else {
                console.error('Elemento battle-screen n√£o encontrado!');
                return;
            }
            
            // Limpa o log de batalha
            const battleLog = document.getElementById('battle-log');
            if (battleLog) {
                battleLog.innerHTML = '';
            }
            
            // Atualiza a interface da batalha
            updateBattleUI();
            
            // Adiciona mensagem de in√≠cio de batalha
            addToBattleLog(`Voc√™ encontrou um ${gameState.currentEnemy.name} n√≠vel ${gameState.currentEnemy.level}!`);
        }

        // Ataque do jogador
        function playerAttack() {
            if (!gameState.inBattle) return;
            
            const player = gameState.player;
            const enemy = gameState.currentEnemy;
            
            // Dano do jogador
            const playerDamage = Math.max(1, player.stats.attack - (enemy.defense / 2));
            enemy.health -= playerDamage;
            addToBattleLog(`Voc√™ atacou e causou ${playerDamage} de dano!`);
            
            // Verifica se o inimigo foi derrotado
            if (enemy.health <= 0) {
                enemy.health = 0;
                endBattle(true);
                return;
            }
            
            // Ataque do inimigo
            setTimeout(() => {
                if (!gameState.inBattle) return; // Se a batalha j√° terminou, n√£o faz nada
                
                const enemyDamage = Math.max(1, enemy.attack - (player.stats.defense / 2));
                player.stats.health -= enemyDamage;
                addToBattleLog(`${enemy.name} te atacou e causou ${enemyDamage} de dano!`);
                
                // Verifica se o jogador foi derrotado
                if (player.stats.health <= 0) {
                    player.stats.health = 0;
                    endBattle(false);
                    return;
                }
                
                // Atualiza a interface
                updateBattleUI();
                updateUI();
            }, 500);
            
            // Atualiza a interface
            updateBattleUI();
            updateUI();
        }

        // Tenta fugir da batalha
        function tryToFlee() {
            const success = Math.random() > 0.3; // 70% de chance de fugir
            
            if (success) {
                addToBattleLog("Voc√™ fugiu da batalha!");
                setTimeout(() => {
                    gameState.inBattle = false;
                    document.getElementById('battle-screen').style.display = 'none';
                }, 1000);
            } else {
                addToBattleLog("Voc√™ n√£o conseguiu fugir!");
                
                // Inimigo ataca quando o jogador tenta fugir
                setTimeout(() => {
                    if (!gameState.inBattle) return;
                    
                    const enemy = gameState.currentEnemy;
                    const player = gameState.player;
                    
                    const enemyDamage = Math.max(1, enemy.attack - (player.stats.defense / 2));
                    player.stats.health -= enemyDamage;
                    addToBattleLog(`${enemy.name} te atacou e causou ${enemyDamage} de dano!`);
                    
                    // Verifica se o jogador foi derrotado
                    if (player.stats.health <= 0) {
                        player.stats.health = 0;
                        endBattle(false);
                        return;
                    }
                    
                    updateBattleUI();
                    updateUI();
                }, 500);
            }
        }

        // Finaliza a batalha
        function endBattle(playerWon) {
            gameState.inBattle = false;
            
            if (playerWon) {
                const enemy = gameState.currentEnemy;
                const expGained = enemy.exp;
                const goldGained = Math.floor(Math.random() * (enemy.gold * 0.5)) + (enemy.gold / 2);
                
                // Adiciona EXP e ouro
                gameState.player.exp += expGained;
                gameState.player.stats.gold += goldGained;
                
                // Verifica se subiu de n√≠vel
                checkLevelUp();
                
                // Atualiza a interface
                updateUI();
                
                // Mostra a tela de vit√≥ria
                document.getElementById('victory-text').textContent = 
                    `Voc√™ derrotou ${enemy.name} e ganhou ${expGained} de EXP e ${goldGained} de ouro!`;
                document.getElementById('victory-screen').style.display = 'flex';
                
                // Desbloqueia novas regi√µes se necess√°rio
                unlockNewRegions();
            } else {
                // Derrota
                document.getElementById('defeat-screen').style.display = 'flex';
                
                // Recupera um pouco de vida ap√≥s a derrota
                gameState.player.stats.health = Math.floor(gameState.player.stats.maxHealth * 0.3);
                updateUI();
            }
            
            // Esconde a tela de batalha
            document.getElementById('battle-screen').style.display = 'none';
        }

        // Atualiza a interface da batalha
        function updateBattleUI() {
            const enemy = gameState.currentEnemy;
            if (!enemy) return;
            
            // Atualiza as informa√ß√µes do inimigo
            document.getElementById('enemy-name').textContent = enemy.name;
            document.getElementById('enemy-level').textContent = enemy.level;
            document.getElementById('enemy-health-text').textContent = 
                `${Math.max(0, enemy.health)}/${enemy.maxHealth}`;
            
            // Atualiza a imagem do inimigo
            const enemyImage = document.getElementById('enemy-image');
            if (enemyImage) {
                if (enemy.image) {
                    enemyImage.src = enemy.image;
                    enemyImage.alt = enemy.name;
                    enemyImage.style.display = 'block';
                } else {
                    enemyImage.style.display = 'none';
                }
            }
            
            // Atualiza a barra de vida do inimigo
            const healthPercent = (enemy.health / enemy.maxHealth) * 100;
            document.getElementById('enemy-health-bar').style.width = `${healthPercent}%`;
            
            // Atualiza a barra de vida do jogador
            const player = gameState.player;
            const playerHealthPercent = (player.stats.health / player.stats.maxHealth) * 100;
            document.getElementById('player-health').textContent = 
                `${Math.max(0, player.stats.health)}/${player.stats.maxHealth}`;
            document.getElementById('hp-bar').style.width = `${playerHealthPercent}%`;
            document.getElementById('hp-text').textContent = 
                `${Math.max(0, player.stats.health)}/${player.stats.maxHealth}`;
        }

        // Continua ap√≥s a vit√≥ria
        function continueAfterVictory() {
            document.getElementById('victory-screen').style.display = 'none';
            saveGame();
        }

        // Tenta novamente ap√≥s a derrota
        function retryBattle() {
            document.getElementById('defeat-screen').style.display = 'none';
            saveGame();
        }

        // Verifica se o jogador subiu de n√≠vel
        function checkLevelUp() {
            const player = gameState.player;
            
            while (player.exp >= player.expToNextLevel) {
                player.level++;
                player.exp -= player.expToNextLevel;
                player.expToNextLevel = Math.floor(player.expToNextLevel * 1.5);
                
                // Melhora os status do jogador
                player.stats.maxHealth += 10;
                player.stats.health = player.stats.maxHealth;
                player.stats.attack += 2;
                player.stats.defense += 1;
                
                addToBattleLog(`Parab√©ns! Voc√™ subiu para o n√≠vel ${player.level}!`);
            }
        }

        // Desbloqueia novas regi√µes com base no n√≠vel do jogador
        function unlockNewRegions() {
            const playerLevel = gameState.player.level;
            const regions = document.querySelectorAll('.region');
            let unlockedAny = false;
            
            regions.forEach(region => {
                const regionName = region.getAttribute('data-region');
                const levelRange = region.getAttribute('data-level');
                
                // Garante que a regi√£o da floresta esteja sempre desbloqueada
                if (regionName === 'floresta') {
                    region.classList.remove('locked');
                    region.style.cursor = 'pointer';
                    return; // Pula para a pr√≥xima itera√ß√£o
                }
                
                if (levelRange) {
                    const minLevel = parseInt(levelRange.split('-')[0]);
                    if (playerLevel >= minLevel - 2) { // Desbloqueia regi√µes at√© 2 n√≠veis abaixo
                        const wasLocked = region.classList.contains('locked');
                        region.classList.remove('locked');
                        region.style.cursor = 'pointer';
                        console.log(`Regi√£o ${regionName} desbloqueada!`);
                        
                        if (wasLocked) {
                            unlockedAny = true;
                            region.style.animation = 'pulse 1s';
                            setTimeout(() => {
                                region.style.animation = '';
                            }, 1000);
                        }
                    }
                }
            });
            
            if (unlockedAny) {
                addToBattleLog("Novas √°reas foram desbloqueadas no mapa!");
            }
        }

        // Fun√ß√µes de invent√°rio
        function addItemToInventory(itemId, quantity = 1) {
            const item = gameItems[itemId];
            if (!item) return false;
            
            const inventory = gameState.player.inventory;
            const existingItem = inventory.items.find(i => i.id === itemId);
            
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                if (inventory.items.length >= inventory.maxSlots) {
                    addToBattleLog('Seu invent√°rio est√° cheio!');
                    return false;
                }
                inventory.items.push({
                    id: itemId,
                    quantity: quantity
                });
            }
            
            addToBattleLog(`Voc√™ obteve ${quantity}x ${item.name}!`);
            saveGame();
            updateUI();
            return true;
        }
        
        function removeItemFromInventory(itemId, quantity = 1) {
            const inventory = gameState.player.inventory;
            const itemIndex = inventory.items.findIndex(i => i.id === itemId);
            
            if (itemIndex === -1) return false;
            
            const item = inventory.items[itemIndex];
            
            if (item.quantity > quantity) {
                item.quantity -= quantity;
            } else {
                inventory.items.splice(itemIndex, 1);
            }
            
            saveGame();
            updateUI();
            return true;
        }
        
        function useItem(itemId) {
            const item = gameItems[itemId];
            if (!item) return false;
            
            const player = gameState.player;
            
            // Verifica se o item est√° no invent√°rio
            const inventoryItem = player.inventory.items.find(i => i.id === itemId);
            if (!inventoryItem) return false;
            
            // Aplica o efeito do item
            let message = '';
            
            if (item.type === 'consumable') {
                if (item.effect.health) {
                    player.stats.health = Math.min(
                        player.stats.maxHealth, 
                        player.stats.health + item.effect.health
                    );
                    message = `Voc√™ recuperou ${item.effect.health} de vida!`;
                }
                
                if (item.effect.mana) {
                    player.stats.mana = Math.min(
                        player.stats.maxMana, 
                        player.stats.mana + item.effect.mana
                    );
                    message = message ? message + ' E ' : 'Voc√™ ';
                    message += `recuperou ${item.effect.mana} de mana!`;
                }
                
                // Remove o item do invent√°rio ap√≥s o uso
                removeItemFromInventory(itemId, 1);
            } else if (item.type === 'weapon' || item.type === 'armor') {
                // Equipa o item
                const slot = item.type;
                const previousItem = player.inventory.equipped[slot];
                
                // Se j√° tiver um item equipado, remove seus b√¥nus
                if (previousItem) {
                    const previousItemData = gameItems[previousItem];
                    if (previousItemData) {
                        Object.entries(previousItemData.effect).forEach(([stat, value]) => {
                            player.stats[stat] -= value;
                        });
                    }
                }
                
                // Equipa o novo item
                player.inventory.equipped[slot] = itemId;
                
                // Aplica os b√¥nus do novo item
                Object.entries(item.effect).forEach(([stat, value]) => {
                    player.stats[stat] += value;
                });
                
                message = `Voc√™ equipou ${item.name}!`;
                
                // Se o item estava no invent√°rio, remove-o
                removeItemFromInventory(itemId, 1);
                
                // Se havia um item equipado, adiciona de volta ao invent√°rio
                if (previousItem) {
                    addItemToInventory(previousItem, 1);
                }
            }
            
            // Atualiza a UI
            updateUI();
            updateStatusDisplay();
            
            if (message) {
                addToBattleLog(message);
            }
            
            return true;
}

// Fun√ß√£o auxiliar para mesclar objetos profundamente
function deepMerge(target, source) {
    if (typeof target !== 'object' || target === null) {
        return source;
    }

    const output = Object.assign({}, target);
    Object.keys(source).forEach(key => {
        if (source[key] instanceof Object && key in target) {
            output[key] = deepMerge(target[key], source[key]);
        } else {
            output[key] = source[key];
        }
    });
    return output;
}

// Carrega o jogo salvo
function loadGame() {
    const savedGame = localStorage.getItem('blazeAndSteelSave');
    if (savedGame) {
        const savedState = JSON.parse(savedGame);

        // Estado padr√£o do jogo
        const defaultState = {
            player: {
                level: 1,
                exp: 0,
                expToNextLevel: 100,
                stats: {
                    health: 100,
                    maxHealth: 100,
                    mana: 50,
                    maxMana: 50,
                    attack: 10,
                    defense: 5,
                    gold: 50
                },
                unlockedRegions: ['floresta'],
                inventory: {
                    items: [],
                    maxSlots: 20,
                    equipped: {
                        weapon: null,
                        armor: null,
                        accessory: null
                    }
                }
            },
            currentEnemy: null,
            inBattle: false,
            battleLog: []
        };

        // Faz uma c√≥pia profunda do estado padr√£o
        gameState = JSON.parse(JSON.stringify(defaultState));

        // Mescla os estados de forma profunda
        gameState = deepMerge(gameState, savedState);

        // Garante que o invent√°rio tenha a estrutura correta
        if (!gameState.player.inventory) {
            gameState.player.inventory = {
                items: [],
                maxSlots: 20,
                equipped: {
                    weapon: null,
                    armor: null,
                    accessory: null
                }
            };
        } else {
            // Garante que os itens do invent√°rio existam
            if (!Array.isArray(gameState.player.inventory.items)) {
                gameState.player.inventory.items = [];
            }
            // Garante que os slots equipados existam
            if (!gameState.player.inventory.equipped) {
                gameState.player.inventory.equipped = {
                    weapon: null,
                    armor: null,
                    accessory: null
                };
            }
            // Garante que maxSlots existe
            if (typeof gameState.player.inventory.maxSlots !== 'number') {
                gameState.player.inventory.maxSlots = 20;
            }
        }

        // Garante que as estat√≠sticas tenham todos os campos necess√°rios
        const defaultStats = {
            health: 100,
            maxHealth: 100,
            mana: 50,
            maxMana: 50,
            attack: 10,
            defense: 5,
            gold: 50
        };

        gameState.player.stats = { ...defaultStats, ...gameState.player.stats };

        // Atualiza as regi√µes desbloqueadas
        document.querySelectorAll('.region').forEach(region => {
            const regionName = region.getAttribute('data-region');
            if (gameState.player.unlockedRegions && gameState.player.unlockedRegions.includes(regionName)) {
                region.classList.remove('locked');
            }
        });

        console.log('Jogo carregado com sucesso!');
    } else {
        console.log('Nenhum jogo salvo encontrado. Iniciando novo jogo...');
    }
}

// O jogo √© iniciado automaticamente pela fun√ß√£o startGame()
// quando o DOM estiver pronto

// Adiciona uma mensagem ao log de batalha
function addToBattleLog(message) {
    const log = document.getElementById('battle-log');
    const entry = document.createElement('div');
    entry.className = 'log-entry';
    entry.textContent = message;
    log.appendChild(entry);
    log.scrollTop = log.scrollHeight;

    // Limita o n√∫mero de entradas no log
    while (log.children.length > 50) {
        log.removeChild(log.firstChild);
    }
}

// Desbloqueia novas regi√µes com base no n√≠vel do jogador
function unlockNewRegions() {
    console.log('=== IN√çCIO DA FUN√á√ÉO unlockNewRegions ===');
    const playerLevel = gameState.player.level;
    const regions = document.querySelectorAll('.region');
    let unlockedAny = false;

    // Garante que a floresta esteja sempre desbloqueada
    const florestaRegion = document.querySelector('.region[data-region="floresta"]');
    if (florestaRegion) {
        console.log('Garantindo que a regi√£o da floresta est√° desbloqueada...');
        florestaRegion.classList.remove('locked');
        florestaRegion.style.cursor = 'pointer';
        
        // Garante que a regi√£o da floresta esteja na lista de regi√µes desbloqueadas
        if (!gameState.player.unlockedRegions) {
            gameState.player.unlockedRegions = [];
        }
        
        if (!gameState.player.unlockedRegions.includes('floresta')) {
            gameState.player.unlockedRegions.push('floresta');
            console.log('Regi√£o da floresta adicionada √†s regi√µes desbloqueadas');
        }
    } else {
        console.error('Regi√£o da floresta n√£o encontrada no DOM!');
    }

    // Desbloqueia outras regi√µes com base no n√≠vel
    regions.forEach(region => {
        const regionName = region.getAttribute('data-region');
        const levelRange = region.getAttribute('data-level');
        
        if (!levelRange) {
            console.warn(`Regi√£o ${regionName} n√£o tem o atributo data-level`);
            return;
        }
        
        const minLevel = parseInt(levelRange.split('-')[0]);
        
        if (playerLevel >= minLevel) {
            const wasLocked = region.classList.contains('locked');
            region.classList.remove('locked');
            region.style.cursor = 'pointer';
            
            if (wasLocked) {
                console.log(`Regi√£o ${regionName} desbloqueada!`);
                if (!gameState.player.unlockedRegions.includes(regionName)) {
                    gameState.player.unlockedRegions.push(regionName);
                    unlockedAny = true;
                    
                    // Adiciona um efeito visual ao desbloquear uma nova regi√£o
                    region.style.animation = 'pulse 1s';
                    setTimeout(() => {
                        region.style.animation = '';
                    }, 1000);
                }
            }
        }
    });

    if (unlockedAny) {
        console.log('Novas √°reas foram desbloqueadas!');
        addToBattleLog("Novas √°reas foram desbloqueadas no mapa!");
    }
    
    console.log('=== FIM DA FUN√á√ÉO unlockNewRegions ===');
}

// Fun√ß√µes de invent√°rio
function addItemToInventory(itemId, quantity = 1) {
    const item = gameItems[itemId];
    if (!item) return false;

    const inventory = gameState.player.inventory;
    const existingItem = inventory.items.find(i => i.id === itemId);

    if (existingItem) {
        existingItem.quantity += quantity;
    } else {
        if (inventory.items.length >= inventory.maxSlots) {
            addToBattleLog('Seu invent√°rio est√° cheio!');
            return false;
        }
        inventory.items.push({
            id: itemId,
            quantity: quantity
        });
    }

    addToBattleLog(`Voc√™ obteve ${quantity}x ${item.name}!`);
    saveGame();
    updateUI();
    return true;
}

function removeItemFromInventory(itemId, quantity = 1) {
    const inventory = gameState.player.inventory;
    const itemIndex = inventory.items.findIndex(i => i.id === itemId);

    if (itemIndex === -1) return false;

    const item = inventory.items[itemIndex];

    if (item.quantity > quantity) {
        item.quantity -= quantity;
    } else {
        inventory.items.splice(itemIndex, 1);
    }

    saveGame();
    updateUI();
    return true;
}

function useItem(itemId) {
    const item = gameItems[itemId];
    if (!item) return false;

    const player = gameState.player;

    // Verifica se o item est√° no invent√°rio
    const inventoryItem = player.inventory.items.find(i => i.id === itemId);
    if (!inventoryItem) return false;

    // Aplica o efeito do item
    let message = '';

    if (item.type === 'consumable') {
        if (item.effect.health) {
            player.stats.health = Math.min(
                player.stats.maxHealth,
                player.stats.health + item.effect.health
            );
            message = `Voc√™ recuperou ${item.effect.health} de vida!`;
        }

        if (item.effect.mana) {
            player.stats.mana = Math.min(
                player.stats.maxMana,
                player.stats.mana + item.effect.mana
            );
            message = message ? message + ' E ' : 'Voc√™ ';
            message += `recuperou ${item.effect.mana} de mana!`;
        }

        // Remove o item do invent√°rio ap√≥s o uso
        removeItemFromInventory(itemId, 1);
    } else if (item.type === 'weapon' || item.type === 'armor') {
        // Equipa o item
        const slot = item.type;
        const previousItem = player.inventory.equipped[slot];

        // Se j√° tiver um item equipado, remove seus b√¥nus
        if (previousItem) {
            const previousItemData = gameItems[previousItem];
            if (previousItemData) {
                Object.entries(previousItemData.effect).forEach(([stat, value]) => {
                    player.stats[stat] -= value;
                });
            }
        }

        // Equipa o novo item
        player.inventory.equipped[slot] = itemId;

        // Aplica os b√¥nus do novo item
        Object.entries(item.effect).forEach(([stat, value]) => {
            player.stats[stat] += value;
        });

        message = `Voc√™ equipou ${item.name}!`;

        // Se o item estava no invent√°rio, remove-o
        removeItemFromInventory(itemId, 1);

        // Se havia um item equipado, adiciona de volta ao invent√°rio
        if (previousItem) {
            addItemToInventory(previousItem, 1);
        }
    }

    // Atualiza a UI
    updateUI();
    updateStatusDisplay();

    if (message) {
        addToBattleLog(message);
    }

    return true;
}

// Verifica se o jogador subiu de n√≠vel
function checkLevelUp() {
    const player = gameState.player;

    while (player.exp >= player.expToNextLevel) {
        player.level++;
        player.exp -= player.expToNextLevel;
        player.expToNextLevel = Math.floor(player.expToNextLevel * 1.5);

        // Melhora os status do jogador
        player.stats.maxHealth += 10;
        player.stats.health = player.stats.maxHealth;
        player.stats.attack += 2;
        player.stats.defense += 1;

        addToBattleLog(`Parab√©ns! Voc√™ subiu para o n√≠vel ${player.level}!`);
    }
}

// Continua ap√≥s a vit√≥ria
function continueAfterVictory() {
    document.getElementById('victory-screen').style.display = 'none';
    saveGame();
}

// Tenta novamente ap√≥s a derrota
function retryBattle() {
    document.getElementById('defeat-screen').style.display = 'none';
    saveGame();
}

// Inicializa√ß√£o do jogo
function initGame() {
    try {
        console.log('Iniciando jogo...');
        
        // Configura os event listeners do modal de status
        const statusBtn = document.getElementById('status-btn');
        const closeStatusBtn = document.getElementById('close-status');
        const statusModal = document.getElementById('status-modal');
        
        if (statusBtn && statusModal) {
            // Abrir modal de status
            statusBtn.addEventListener('click', function() {
                console.log('Abrindo modal de status');
                statusModal.style.display = 'flex';
                // Pequeno atraso para garantir que o display: flex seja aplicado antes da anima√ß√£o
                setTimeout(() => {
                    statusModal.classList.add('show');
                    updateStatusDisplay();
                }, 10);
            });
            
            // Fechar modal de status
            if (closeStatusBtn) {
                closeStatusBtn.addEventListener('click', function() {
                    console.log('Fechando modal de status');
                    statusModal.classList.remove('show');
                    setTimeout(() => {
                        statusModal.style.display = 'none';
                    }, 300);
                });
            }
            
            // Fechar modal ao clicar fora do conte√∫do
            statusModal.addEventListener('click', function(e) {
                if (e.target === statusModal) {
                    console.log('Clicou fora do modal, fechando...');
                    statusModal.classList.remove('show');
                    setTimeout(() => {
                        statusModal.style.display = 'none';
                    }, 300);
                }
            });
        } else {
            console.error('Elementos do modal de status n√£o encontrados!');
        }
        
        // Configura os event listeners das regi√µes
        const regions = document.querySelectorAll('.region');
        console.log(`Encontradas ${regions.length} regi√µes no DOM`);
        
        regions.forEach(region => {
            const regionName = region.getAttribute('data-region');
            console.log(`Configurando evento para regi√£o: ${regionName}`);
            
            // Adiciona estilo para facilitar a identifica√ß√£o visual
            region.style.border = '2px solid red';
            
            region.addEventListener('click', function regionClickHandler(e) {
                console.log('=== CLIQUE NA REGI√ÉO DETECTADO ===');
                console.log('Evento de clique:', e);
                console.log('Elemento clicado:', this);
                console.log('Regi√£o clicada:', regionName);
                const isLocked = this.classList.contains('locked');
                console.log('Est√° trancada?', isLocked);
                
                // Impede o comportamento padr√£o do link
                e.preventDefault();
                e.stopPropagation();
                
                console.log('=== DETALHES DO ELEMENTO CLICADO ===');
                console.log('ID:', this.id);
                console.log('Classes:', this.className);
                console.log('Data Attributes:', {
                    'data-region': this.getAttribute('data-region'),
                    'data-level': this.getAttribute('data-level')
                });
                
                // Verifica se o elemento est√° vis√≠vel
                const style = window.getComputedStyle(this);
                console.log('=== ESTILOS DO ELEMENTO ===');
                console.log('display:', style.display);
                console.log('visibility:', style.visibility);
                console.log('opacity:', style.opacity);
                console.log('pointer-events:', style.pointerEvents);
                
                if (!isLocked) {
                    console.log('Tentando redirecionar para a regi√£o:', regionName);
                    
                    // Mapeia os nomes das regi√µes para os arquivos HTML
                    const regionPages = {
                        'floresta': 'floresta-iniciantes.html',
                        'deserto': 'deserto-ardente.html',
                        'montanha': 'montanhas-gelidas.html',
                        'pantano': 'pantano-sombrio.html',
                        'castelo': 'castelo-rei-demonio.html'
                    };
                    
                    const targetPage = regionPages[regionName];
                    console.log('P√°gina de destino mapeada:', targetPage);
                    
                    if (targetPage) {
                        console.log('=== TENTANDO ACESSAR O ARQUIVO ===');
                        const basePath = window.location.pathname.replace('mapa-mundi.html', '');
                        const fullPath = basePath + targetPage;
                        console.log('Caminho completo:', window.location.origin + fullPath);
                        
                        // Verifica se o arquivo existe
                        fetch(fullPath, { method: 'HEAD' })
                            .then(response => {
                                if (response.ok) {
                                    console.log('Arquivo encontrado, redirecionando para:', fullPath);
                                    window.location.href = fullPath;
                                } else {
                                    console.error('Erro ao acessar o arquivo:', response.status, response.statusText);
                                    alert(`Erro ao acessar a regi√£o: ${regionName} (${response.status} ${response.statusText})`);
                                }
                            })
                            .catch(error => {
                                console.error('Erro ao verificar o arquivo:', error);
                                // Tenta redirecionar mesmo assim
                                console.log('Tentando redirecionar apesar do erro...');
                                window.location.href = fullPath;
                            });
                        
                        // Impede que o evento continue a propaga√ß√£o
                        e.stopImmediatePropagation();
                        return false;
                    } else {
                        console.error(`P√°gina n√£o encontrada para a regi√£o: ${regionName}`);
                        alert(`P√°gina da regi√£o ${regionName} n√£o encontrada!`);
                    }
                } else {
                    console.log(`Regi√£o ${regionName} est√° trancada!`);
                    console.log(`Classes do elemento:`, this.className);
                    alert('Esta regi√£o est√° trancada! Aumente seu n√≠vel para desbloque√°-la.');
                }
            });
        });
        
        console.log('Jogo inicializado com sucesso!');
    } catch (error) {
        console.error('Erro durante a inicializa√ß√£o do jogo:', error);
        alert('Ocorreu um erro ao carregar o jogo. Verifique o console para mais detalhes.');
    }
}

// Inicializa o jogo quando o DOM estiver totalmente carregado
function initializeGame() {
    try {
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initGame);
        } else {
            // DOM j√° carregado
            initGame();
        }
    } catch (error) {
        console.error('Erro durante a inicializa√ß√£o do jogo:', error);
        alert('Ocorreu um erro ao carregar o jogo. Verifique o console para mais detalhes.');
    }
}

// Inicia o jogo
initializeGame();